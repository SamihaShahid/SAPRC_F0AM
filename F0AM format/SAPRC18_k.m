function K = SAPRC18_k(Met)
%SAPRC18 k calculation file

struct2var(Met)
nk = 20; %number of rate constants
R = 0.0019872; % ideal gas constant, kcal/K/mol
krx = nan(length(T),nk);
Knames = cell(nk,1);
i=0;

%% Complex rate constant calculation steps

i=i+1;
Knames{i} = 'kf_O3P_NO';
A0=9.00e-32;
E0=0.000;
B0=-1.50;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=3.00e-11;
Einf=0.000;
Binf=0.00;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_O3P_NO2';
A0=2.50e-31;
E0=0.000;
B0=-1.80;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=2.20e-11;
Einf=0.000;
Binf=-0.70;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_NO2_NO3';
A0=3.60e-30;
E0=0.000;
B0=-4.10;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=1.90e-12;
Einf=0.000;
Binf=0.20;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.35;
N=1.33;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_N2O5';
A0=1.30e-03;
E0=21.859;
B0=-3.50;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=9.70e+14;
Einf=22.018;
Binf=0.10;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.35;
N=1.33;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_OH_NO';
A0=7.00e-31;
E0=0.000;
B0=-2.60;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=3.60e-11;
Einf=0.000;
Binf=-0.10;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_OH_NO2';
A0=3.20e-30;
E0=0.000;
B0=-4.50;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=3.00e-11;
Einf=0.000;
Binf=0.00;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.41;
N=1.24;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;
 
i=i+1;
Knames{i} = 'kf_HO2_NO2';
A0=1.40e-31;
E0=0.000;
B0=-3.10;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=4.00e-12;
Einf=0.000;
Binf=0.00;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.40;
N=1.26;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;
 
i=i+1;
Knames{i} = 'kf_HNO4';
A0=4.10e-05;
E0=21.164;
B0=0.00;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=6.00e+15;
Einf=22.197;
Binf=0.00;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.40;
N=1.26;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_SO2_OH';
A0=3.30e-31;
E0=0.000;
B0=-4.30;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=1.60e-12;
Einf=0.000;
Binf=0.00;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_ETHEN_OH';
A0=1.10e-28;
E0=0.000;
B0=-3.50;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=8.40e-12;
Einf=0.000;
Binf=-1.75;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_ACETL_OH';
A0=5.50e-30;
E0=0.000;
B0=0.00;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=8.30e-13;
Einf=0.000;
Binf=2.00;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;
 
i=i+1;
Knames{i} = 'kf_MECO3_NO2';
A0=9.70e-29;
E0=0.000;
B0=-5.60;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=9.30e-12;
Einf=0.000;
Binf=-1.50;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_PAN';
A0=1.08e+00;
E0=27.821;
B0=-5.60;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=1.03e+17;
Einf=27.821;
Binf=-1.50;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;
 
i=i+1;
Knames{i} = 'kf_ETCO3_NO2';
A0=9.00e-28;
E0=0.000;
B0=-8.90;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=7.70e-12;
Einf=0.000;
Binf=-0.20;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'kf_PPN';
A0=1.00e+01;
E0=27.821;
B0=-8.90;
k0 = A0.*(T./300).^B0.*exp(-E0./(R.*T));
Ainf=8.56e+16;
Einf=27.821;
Binf=-0.20;
kinf = Ainf.*(T./300).^Binf.*exp(-Einf./(R.*T));
F=0.60;
N=1.00;
Z = (1 + (log10((k0.*M)./kinf)/N).^2 ).^(-1); 
krx(:,i) = (k0.*M./(1+k0.*M./kinf)).*F.^Z;

i=i+1;
Knames{i} = 'k_OH_HNO3';
A1=2.40e-14;
E1=-0.914;
B1=0.00;
k1 = A1.*(T./300).^B1.*exp(-E1./(R.*T));
A2=2.7e-17;
E2=-4.370;
B2=0.00;
k2 = A2.*(T./300).^B2.*exp(-E2./(R.*T));
A3=6.50e-34;
E3=-2.653;
B3=0.00;
k3 = A3.*(T./300).^B3.*exp(-E3./(R.*T));
krx(:,i) = k1+k3.*M./(1+k3.*M./k2);

i=i+1;
Knames{i} = 'k_HO2_NO';
A1=2.39e-12;
E1=3.400;
B1=-13.77;
k1 = A1.*(T./300).^B1.*exp(-E1./(R.*T));
A2=1.83e-32;
E2=1.534;
B2=-4.85;
k2 = A2.*(T./300).^B2.*exp(-E2./(R.*T));
krx(:,i) = k1+k2.*M;

i=i+1;
Knames{i} = 'k_HO2_HO2';
A1=3.00e-13;
E1=-0.914;
B1=0.00;
k1 = A1.*(T./300).^B1.*exp(-E1./(R.*T));
A2=2.10e-33;
E2=-1.828;
B2=0.00;
k2 = A2.*(T./300).^B2.*exp(-E2./(R.*T));
krx(:,i) = k1+k2.*M;
 
i=i+1;
Knames{i} = 'k_HO2_HO2_H2O';
A1=4.20e-34;
E1=-5.286;
B1=0.00;
k1 = A1.*(T./300).^B1.*exp(-E1./(R.*T));
A2=2.94e-54;
E2=-6.200;
B2=0.00;
k2 = A2.*(T./300).^B2.*exp(-E2./(R.*T));
krx(:,i) = k1+k2.*M;
 
i=i+1;
Knames{i} = 'k_CO_OH';
A1=1.44e-13;
E1=0.000;
B1=0.000;
k1 = A1.*(T./300).^B1.*exp(-E1./(R.*T));
A2=3.43e-33;
E2=0.000;
B2=0.000;
k2 = A2.*(T./300).^B2.*exp(-E2./(R.*T));
krx(:,i) = k1+k2.*M;
% End
%% accumulate
K = struct;
for i=1:length(Knames)
    K.(Knames{i}) = krx(:,i);
end
